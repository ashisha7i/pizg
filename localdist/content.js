function getSelectedText(){var e="";return void 0!==window.getSelection?e=window.getSelection().toString():void 0!==document.selection&&"Text"==document.selection.type&&(e=document.selection.createRange().text),e}chrome.runtime.onMessage.addListener(function(e,t,o){if(console.log("MESSAGE ---- "+e.action),"clicked_browser_action"===e.action){var n;try{var i=getSelectedText();if(!i)throw new Error("Nothing selected? Please make sure that you have selected the text to decode.");var r=atob(i).split("").map(function(e){return e.charCodeAt(0)}),c=new Uint8Array(r),a=pako.inflate(c);n=new TextDecoder("utf-8").decode(new Uint8Array(a))}catch(e){console.dir(e),n="ERROR : Please verify the selected text and try again."}o({results:n})}else if(e.action="prettify_action"){console.log("Prettify CALLED "+e.type);"XML"===e.type&&vkbeautify.xml(),o({results:"A pretty string"})}});